# Развертывание Lampa Ukraine Parser

Этот документ содержит инструкции по развертыванию парсера на бесплатных платформах.

## Поддерживаемые платформы

### 1. Vercel (Рекомендуется) ⭐

**Преимущества:**
- Бесплатный хостинг
- Автоматическое развертывание из GitHub
- Быстрая работа
- Простая настройка

**Шаги развертывания:**

1. **Подготовка репозитория:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/yourusername/lampa-ukraine-parser.git
   git push -u origin main
   ```

2. **Развертывание на Vercel:**
   - Зайдите на [vercel.com](https://vercel.com)
   - Зарегистрируйтесь или войдите
   - Нажмите "New Project"
   - Подключите ваш GitHub репозиторий
   - Vercel автоматически определит настройки
   - Нажмите "Deploy"

3. **Настройка переменных окружения (опционально):**
   - В настройках проекта добавьте переменные из `env.example`

4. **Получение URL:**
   - После развертывания вы получите URL вида: `https://your-project.vercel.app`
   - Используйте этот URL в конфигурации Lampa

### 2. Netlify

**Шаги развертывания:**

1. **Подготовка проекта:**
   - Убедитесь, что файл `netlify.toml` присутствует в корне проекта

2. **Развертывание:**
   - Зайдите на [netlify.com](https://netlify.com)
   - Зарегистрируйтесь или войдите
   - Перетащите папку проекта в область развертывания
   - Или подключите GitHub репозиторий

3. **Настройка:**
   - В настройках проекта укажите:
     - Build command: `npm install`
     - Publish directory: `.`

### 3. Railway

**Шаги развертывания:**

1. **Подготовка:**
   - Зайдите на [railway.app](https://railway.app)
   - Зарегистрируйтесь через GitHub

2. **Развертывание:**
   - Нажмите "New Project"
   - Выберите "Deploy from GitHub repo"
   - Выберите ваш репозиторий
   - Railway автоматически развернет проект

3. **Настройка переменных:**
   - В настройках проекта добавьте переменные окружения

### 4. Render

**Шаги развертывания:**

1. **Подготовка:**
   - Зайдите на [render.com](https://render.com)
   - Зарегистрируйтесь

2. **Развертывание:**
   - Нажмите "New Web Service"
   - Подключите GitHub репозиторий
   - Настройте:
     - Build Command: `npm install`
     - Start Command: `npm start`

## Проверка развертывания

После развертывания проверьте работу API:

```bash
# Health check
curl https://your-url.vercel.app/health

# Available sources
curl https://your-url.vercel.app/api/search/sources/available

# Search test
curl "https://your-url.vercel.app/api/search?query=test"
```

## Интеграция с Lampa

После получения URL вашего развернутого парсера:

1. Откройте приложение Lampa
2. Перейдите в настройки
3. Найдите раздел "Парсеры" или "Источники"
4. Добавьте новый парсер с конфигурацией:

```json
{
  "name": "Ukraine Parser",
  "type": "custom",
  "base_url": "https://your-url.vercel.app",
  "search_url": "/api/search?query={query}",
  "movie_url": "/api/movie/{id}/full?source={source}",
  "series_url": "/api/series/{id}/full?source={source}",
  "stream_url": "/api/stream/{id}?source={source}"
}
```

## Мониторинг и логи

### Vercel
- Логи доступны в панели управления проекта
- Функция "Functions" показывает статистику использования

### Netlify
- Логи доступны в разделе "Functions"
- Мониторинг в реальном времени

### Railway
- Логи доступны в панели управления
- Мониторинг ресурсов

## Обновление парсера

Для обновления парсера:

1. Внесите изменения в код
2. Зафиксируйте изменения:
   ```bash
   git add .
   git commit -m "Update parser"
   git push
   ```
3. Платформа автоматически переразвернет проект

## Устранение неполадок

### Проблемы с развертыванием

1. **Ошибка сборки:**
   - Проверьте версии Node.js
   - Убедитесь, что все зависимости указаны в `package.json`

2. **Ошибки времени выполнения:**
   - Проверьте логи в панели управления
   - Убедитесь, что переменные окружения настроены правильно

3. **Проблемы с доступом к сайтам:**
   - Некоторые платформы могут блокировать доступ к определенным сайтам
   - Используйте прокси или VPN при необходимости

### Оптимизация производительности

1. **Кэширование:**
   - Включите кэширование в настройках
   - Используйте CDN для статических файлов

2. **Rate Limiting:**
   - Настройте ограничения запросов
   - Мониторьте использование ресурсов

## Поддержка

При возникновении проблем:

1. Проверьте логи развертывания
2. Убедитесь, что все файлы загружены
3. Проверьте настройки переменных окружения
4. Создайте issue в репозитории проекта

## Стоимость

Все перечисленные платформы предлагают бесплатные планы:

- **Vercel:** Бесплатно до 100GB трафика/месяц
- **Netlify:** Бесплатно до 125K запросов/месяц
- **Railway:** Бесплатно до $5 кредитов/месяц
- **Render:** Бесплатно для веб-сервисов с ограничениями

Для большинства пользователей бесплатных планов достаточно. 